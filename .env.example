# ============================================================
# Application (REQUIRED)
# ============================================================

# Application environment
# REQUIRED — no defaults
# Allowed values:
#   - production
#   - staging
#   - development
APP_ENV=production

# Debug mode
# REQUIRED — true / false
# ⚠️ MUST be false in production
APP_DEBUG=false

# Application timezone
# REQUIRED — must be a valid PHP timezone identifier
# Examples: Africa/Cairo, UTC, Europe/Berlin
APP_TIMEZONE=Africa/Cairo

# Application display name
# Used in:
#   - UI headers
#   - Emails
#   - Metadata
APP_NAME="Admin Control Panel"

# Base URL of the admin panel
# Used for:
#   - Redirects
#   - Absolute links
#   - Emails
ADMIN_URL=https://admin.example.com/

# Base URL for admin assets (CSS, JS, images)
# Defaults to "/" if not overridden
ASSET_BASE_URL=/

# Optional logo URL (absolute or relative)
# Used in:
#   - Login page
#   - Emails
LOGO_URL=

# Optional host override for Twig templates
# Used when embedding admin into a host application
HOST_TEMPLATE_PATH=

# ============================================================
# Database (MySQL) — REQUIRED
# ============================================================

# Database host
DB_HOST=127.0.0.1

# Database name
# MUST match imported SQL schema
DB_NAME=admin_control_panel

# Database username
DB_USER=root

# Database password
# ⚠️ Secret — never commit real value
DB_PASS=your_password_here

# ============================================================
# Security — Blind Indexing (REQUIRED)
# ============================================================

# Key used to generate blind indexes for emails
# Used for:
#   - Email uniqueness
#   - Secure lookup without plaintext
#
# Requirements:
#   - Minimum 32 characters
#   - Cryptographically secure
EMAIL_BLIND_INDEX_KEY=GENERATE_SECURE_KEY_MIN_32_CHARS

# ============================================================
# Crypto Key Ring (REQUIRED)
# ============================================================

# Used for:
#   - Encryption / decryption
#   - Key rotation
#
# CRYPTO_KEYS must be a JSON array of objects:
#   { "id": "v1", "key": "HEX_OR_RAW_SECRET" }

# Active crypto key ID
# MUST match one of the IDs in CRYPTO_KEYS
CRYPTO_ACTIVE_KEY_ID=v1

# Crypto keys definition
CRYPTO_KEYS='[{"id":"v1","key":"GENERATE_SECURE_HEX_KEY_MIN_64_CHARS"}]'

# ============================================================
# Password Pepper Ring (REQUIRED)
# ============================================================

# Used for:
#   - Password hashing
#   - Pepper rotation
#
# PASSWORD_PEPPERS must be a JSON object map:
#   { "p1": "secret", "p2": "secret" }

# Active pepper ID
# MUST match a key in PASSWORD_PEPPERS
PASSWORD_ACTIVE_PEPPER_ID=p1

# Pepper secrets
# ⚠️ NOT passwords — random secrets only
PASSWORD_PEPPERS='{"p1":"GENERATE_SECURE_KEY_MIN_32_CHARS"}'

# ============================================================
# Password Hashing — Argon2id (OPTIONAL)
# ============================================================

# Controls password hashing cost parameters
# If omitted, defaults are applied internally
#
# Changing these values:
#   - DOES NOT break existing passwords
#   - Triggers automatic re-hash on next login
#
# Example values are production-safe defaults
PASSWORD_ARGON2_OPTIONS='{"memory_cost":65536,"time_cost":4,"threads":1}'

# ============================================================
# Two-Factor Authentication (TOTP)
# ============================================================

# TOTP issuer name
# Displayed in authenticator apps (Google Authenticator, etc.)
TOTP_ISSUER="Maatify Admin"

# TOTP enrollment expiration (seconds)
# Time allowed between:
#   - Setup
#   - Confirmation
#
# Recommended: 300–600 seconds
TOTP_ENROLLMENT_TTL_SECONDS=600

# ============================================================
# Email Transport (SMTP) — REQUIRED
# ============================================================

# SMTP server host
MAIL_HOST=smtp.example.com

# SMTP server port
MAIL_PORT=587

# SMTP authentication username
MAIL_USERNAME=your_smtp_username

# SMTP authentication password
# ⚠️ Secret
MAIL_PASSWORD=your_smtp_password

# Default sender email address
MAIL_FROM_ADDRESS=no-reply@example.com

# Default sender display name
MAIL_FROM_NAME="Admin Control Panel"

# Optional encryption:
#   - tls
#   - ssl
#   - empty (no encryption)
MAIL_ENCRYPTION=tls

# Optional connection timeout (seconds)
MAIL_TIMEOUT_SECONDS=10

# Optional charset
MAIL_CHARSET=UTF-8

# Optional debug level
# 0 = disabled
# ⚠️ SHOULD remain 0 in production
MAIL_DEBUG_LEVEL=0

# ============================================================
# Logging Configuration (PSR-3)
# ============================================================

# Base path for application logs
# Relative paths resolved from project root
LOG_PATH=storage/logs

# Log retention period (days)
# Old logs beyond this period may be cleaned
LOG_RETENTION_DAYS=14

# Timezone used for log timestamps
# Must be a valid PHP timezone identifier
LOG_TIMEZONE=Africa/Cairo

# ============================================================
# Abuse Protection — Challenge Providers (Bot Mitigation)
# ============================================================
#
# This section configures optional bot-challenge providers
# used by the Abuse Protection system.
#
# IMPORTANT RULES:
# - Exactly ONE provider may be active at runtime.
# - Provider selection is controlled by ABUSE_CHALLENGE_PROVIDER.
# - Setting ABUSE_CHALLENGE_PROVIDER=none fully disables challenges.
#
# Providers are typically applied to public authentication flows
# such as login, password reset, and verification endpoints.
#
# Frontend exposure rules:
# - SITE_KEY may be exposed to frontend rendering (widgets).
# - SECRET_KEY must NEVER be exposed to frontend code.
#

# ============================================================
# Cloudflare Turnstile
# ============================================================
#
# Provider key: "turnstile"
#
# Used for lightweight, privacy-friendly bot mitigation.
# Requires both site key and secret key to be set.
#
# If selected but keys are missing, the system MUST fail fast.
#
TURNSTILE_SITE_KEY='site_key'
TURNSTILE_SECRET_KEY='secret_key'

# ============================================================
# hCaptcha
# ============================================================
#
# Provider key: "hcaptcha"
#
# Alternative challenge provider.
# Enable ONLY when selected via ABUSE_CHALLENGE_PROVIDER.
#
HCAPTCHA_SITE_KEY='site_key'
HCAPTCHA_SECRET_KEY='secret_key'

# ============================================================
# Google reCAPTCHA v2
# ============================================================
#
# Provider key: "recaptcha_v2"
#
# Legacy provider, supported for compatibility only.
# Enable ONLY when selected via ABUSE_CHALLENGE_PROVIDER.
#
RECAPTCHA_V2_SITE_KEY='site_key'
RECAPTCHA_V2_SECRET_KEY='secret_key'

# ============================================================
# Abuse Challenge Provider Selector
# ============================================================
#
# Selects which challenge provider is active at runtime.
#
# Allowed values:
#   - none          : Disable all challenge providers
#   - turnstile     : Cloudflare Turnstile
#   - hcaptcha      : hCaptcha
#   - recaptcha_v2  : Google reCAPTCHA v2
#
# IMPORTANT:
# - Value MUST match exactly one provider.
# - Multiple providers MUST NOT be enabled simultaneously.
# - Invalid values MUST result in startup failure.
#
ABUSE_CHALLENGE_PROVIDER=none

# ============================================================
# Emergency / Recovery Mode (INTERNAL USE ONLY)
# ============================================================
#
# When enabled, the system enters Recovery-Locked Mode.
#
# Effects:
#   - All login attempts are blocked
#   - OTP and verification flows are blocked
#   - Sensitive administrative actions are blocked
#
# Intended for incident response and emergency containment.
#
RECOVERY_MODE=false
