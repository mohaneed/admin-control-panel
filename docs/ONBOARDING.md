ุชูุงู ๐
ูุนุงู ุญูุ ูุฏู **ููุทุฉ ุชุดุบูููุฉ ุฃุณุงุณูุฉ** ูุงุฒู ุชุจูู ูุงุถุญุฉ 100% ูุฃู ูุฑูู ูุจุฏุฃ.

ุชุญุช ุฏู **ุงูููู ูุงูู ุจุนุฏ ุงูุชุญุฏูุซ** ูุน **ุฅุถุงูุฉ ูุณููู ูุงุถุญูู ูุตุฑูุญูู**:

* โ๏ธ **ุงุณุชูุฑุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (SQL Import)**
* โ๏ธ **ุฅูุดุงุก ุฃูู Admin ุนููููุง (ุฎุทูุฉ ุจุฎุทูุฉ ุจุฏูู ูุณุฑ ุงูุฃูู)**

ูุงูุตูุงุบุฉ ูุง ุฒุงูุช **Security-First** ูููููุงุด ุฃู Backdoor ุฃู ุงูุชุฑุงุถุงุช ุบูุท.

---

```
docs/ONBOARDING.md
```

---

# ุฏููู ุจุฏุก ุงูุนูู (Onboarding Guide)

**ุงููุดุฑูุน:** ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ (Admin Control Panel)
**ุงูุญุงูุฉ:** Current State โ Infrastructure-First
**ุงูุชูููุฉ:** PHP 8.2 (Slim Framework) + Slim + Twig + MySQL
**ุงูุฌูููุฑ:** Backend Developers + Frontend (Twig) Developers

---

## 1๏ธโฃ ููุฏูุฉ ุณุฑูุนุฉ (Executive Overview)

ูุฐุง ุงููุดุฑูุน ูู **Backend-Heavy Admin System** ูุจูู ููู ูุจุฏุฃ
**Security-First / Zero-Trust Architecture**.

ูุฐุง **ููุณ** ูุดุฑูุน Features-First ููุง UI-First.

### ูุง ูู ูุฐุง ุงููุดุฑูุนุ

ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒู ูุตูู ููุนูู ูู ุจูุฆุงุช ุญุณุงุณุฉ (ูุงููุฉ / ูุคุณุณูุฉ)ุ ููุนุชูุฏ ุนูู:

* Zero-Trust (ูุง ุซูุฉ ุถูููุฉ ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู)
* Middleware Pipeline ูุชุนุฏุฏ ุงูุทุจูุงุช
* Sessions Server-Side Authority
* Step-Up Authentication ููุนูููุงุช ุงูุญุณุงุณุฉ
* Audit ุฅูุฒุงูู ููู ูุนู ุฅุฏุงุฑู ููู

### ุชุญุฐูุฑ ูุงู โ

> **ุฃู ุชุนุฏูู ุจุฏูู ููู ูุงูู ููุฐู ุงููุซููุฉ = ูุฎุงุทุฑุฉ ุฃูููุฉ ุนุงููุฉ.**
> ุงูุชุนููุฏ ุงูููุฌูุฏ ูู ุงูููุฏ **ููุตูุฏ** ูููุณ ุตุฏูุฉ.
> ูุง ุชุญุงูู ุงูุงูุชูุงู ุนููู ุฃู โุชุจุณูุทูโ.

---

## 2๏ธโฃ ุทุฑููุฉ ุงูุนูู ูุน GitHub (Workflow)

1. **Clone**

   ```bash
   git clone <repository-url>
   ```

2. **Branching Strategy**

    * Features: `feature/your-feature-name`
    * Fixes: `fix/issue-description`

3. **Pull Safety**

   ```bash
   git pull origin main --rebase
   ```

4. **ููููุน ููุงุฆููุง**

    * โ Push ูุจุงุดุฑ ุนูู `main`
    * โ Merge ุจุฏูู Review

5. **Clean History**

    * Squash ูุจู ุงูุฏูุฌ
    * Git history ูุธูู = Debug ุฃุณูู + Audit ุฃูุถุญ

---

## 3๏ธโฃ ุชุดุบูู ุงููุดุฑูุน ูุญูููุง (Local Setup)

### ุงููุชุทูุจุงุช

* PHP 8.2+
* Extensions:

    * pdo
    * openssl
    * redis
    * mbstring
* Composer

---

### ุฎุทูุงุช ุงูุชุดุบูู

#### 1๏ธโฃ ุชุซุจูุช ุงูุญุฒู

```bash
composer install
```

#### 2๏ธโฃ ุฅุนุฏุงุฏ ุงูุจูุฆุฉ

* ุงูุณุฎ:

  ```
  .env.example โ .env
  ```
* ุนุฏูู ุจูุงูุงุช ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช.

โ๏ธ **ููุงุญุธุฉ ุฃูููุฉ ุจุฎุตูุต ุงูููุงุชูุญ**

```md
ูุฌุจ ุชูููุฏ ููุงุชูุญ ุงูุชุดููุฑ ุจุงุณุชุฎุฏุงู CSPRNG.
โ ููููุน ุงุณุชุฎุฏุงู ูููุงุช ูุฑูุฑ ุฃู ูุตูุต ูุฏููุฉ.
ูู ุญุงู ุงูุดูุ ุงุณุฃู ุงููุฑูู ุงูุฃุณุงุณู.
```

---

## 4๏ธโฃ ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (SQL Import) โ **REQUIRED**

ูุจู ุฃู ุชุดุบูู ูุนููุ ูุฌุจ **ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุณุชูุฑุงุฏ ุงูู Schema**.

### ููู ุงูู SQL

* ููุฌุฏ ุฏุงุฎู ุงููุดุฑูุน ููู SQL ุฑุณูู (Schema only)
* ุงูููู ูุญุชูู:

    * ุงูุฌุฏุงูู
    * ุงููููุฏ
    * ุงูููุงุชูุญ
* โ ูุง ูุญุชูู ุฃู:

    * Admin ุงูุชุฑุงุถู
    * ุจูุงูุงุช Seed
    * ุญุณุงุจุงุช ุฌุงูุฒุฉ

### ุทุฑููุฉ ุงูุงุณุชูุฑุงุฏ

#### ุนุจุฑ phpMyAdmin

1. ุฃูุดุฆ Database ูุงุฑุบุฉ (ูุซูุงู: `admin_control_panel`)
2. ุงูุชุญ phpMyAdmin
3. ุงุฎุชุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. Import โ ุงุฎุชุฑ ููู ุงูู `.sql`
5. Execute

#### ุฃู ุนุจุฑ CLI (ุงุฎุชูุงุฑู)

```bash
mysql -u USER -p DB_NAME < schema.sql
```

๐ **ููู ุฌุฏูุง**

> ุจุนุฏ ุงูุงุณุชูุฑุงุฏ:
>
> * ูุงุนุฏุฉ ุงูุจูุงูุงุช ุณุชููู **ูุงุฑุบุฉ ูู ุฃู Admin**
> * ุงููุธุงู ุณูุจูู ูู ูุถุน **LOCKED**
> * ูุฐุง ุงูุณููู ุทุจูุนู ููุชููุนุ ูููุณ ุฎุทุฃ ูู ุงูุชุดุบูู.

---

## 5๏ธโฃ ุฅูุดุงุก ุฃูู Admin (BOOTSTRAP) โ **CRITICAL**

> โ๏ธ **ุฃูู ุฌุฒุก ูู ุงููุธุงู ููู**

ุงููุธุงู ูุจุฏุฃ ุฏุงุฆููุง ูู ูุถุน:

```
BOOTSTRAP_REQUIRED
```

* โ ูุง ููุฌุฏ Admin ุงูุชุฑุงุถู
* โ ูุง ููุฌุฏ Register API
* โ ูุง ูุฌูุฒ ุฅุถุงูุฉ Admin ุนุจุฑ SQL

---

### ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ุงููุญูุฏุฉ

#### 1๏ธโฃ ุชูููุฏ Bootstrap Token (CLI)

* ูุชู ุชูููุฐ **ุฃูุฑ CLI ูุฎุตุต ุฏุงุฎู ุงููุดุฑูุน**
* ุงูุฃูุฑ:

    * ูููุฏ Token ููุฑุฉ ูุงุญุฏุฉ
    * ูู TTL
    * ูุญููุธ Hash ููุท ูู DB

> ูุง ุชุญุงูู ุชุฎููู ุงูุฃูุฑ ุฃู ุฅุนุงุฏุฉ ุชูููุฐู ุจุฏูู ุงูุฑุฌูุน ูููุฑูู ุงูุฃุณุงุณู.
ููุทูุฑ ูุงุฌูุงุช:
ูุณุช ูุทุงูุจูุง ุจุชูููุฐ ูุฐู ุงูุฎุทูุฉ ุจููุณู.
ูููู ุฃู ุชุนุฑู ุฃููุง ุชูููุฐ ูุฑุฉ ูุงุญุฏุฉ ููุท.

---

#### 2๏ธโฃ ุงุณุชุฎุฏุงู ุงูุชููู ุนุจุฑ ุงููุงุฌูุฉ

1. ุงูุชุญ ุงููุธุงู ูู ุงููุชุตูุญ:

   ```
   http://localhost:8080
   ```
2. ุณุชุธูุฑ ุตูุญุฉ ุชุทูุจ **Bootstrap Token**
3. ุฃุฏุฎู ุงูุชููู ุงูุฐู ุชู ุชูููุฏู ูู CLI

---

#### 3๏ธโฃ ุฅูุดุงุก ุฃูู Admin

ุจุนุฏ ูุจูู ุงูุชููู:

* ุฅุฏุฎุงู Email + Password
* ุชุนููู Role ุตุฑูุญ (`system.owner`)
* ุชูุนูู TOTP **ุฅุฌุจุงุฑู**

๐ ุจุนุฏ ุงูุฅููุงู:

* ุงูุชููู ููุจุทู ููุงุฆููุง
* ุงููุธุงู ููุชูู ูู:

  ```
  LOCKED โ ACTIVE
  ```

โ **ุชุญุฐูุฑ**

```md
ุฅุถุงูุฉ Admin ูุฏูููุง ูู DB = Backdoor
ูุณูุชู ุงูุชุดุงูู ุนุจุฑ Audit + Guards
```

---

## 6๏ธโฃ ุงูุฏุฎูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (phpMyAdmin)

### ุงูุฌุฏุงูู ุงููููุฉ

* `admins`
* `identifiers`
* `sessions`
* `audit_outbox`

โ **ูุงุนุฏุฉ ุฐูุจูุฉ**

```md
ุฃู ุชุนุฏูู ูุฏูู ุนูู ุงูุฌุฏุงูู ุงูุฃูููุฉ ููุนุชุจุฑ Tampering.
ุงููุธุงู ูุฏ:
- ููุณูุท ุงูุฌูุณุงุช
- ููุจุทู ุงููุตูู
- ูุณุฌู Audit ุญุฏุซ ุฃููู ุญุฑุฌ
```

---

## 7๏ธโฃ ุฎุฑูุทุฉ ุงูู Endpoints ุงูุญุงููุฉ (CURRENT ONLY)

### Auth

```
POST /auth/login
POST /auth/logout
POST /auth/totp/verify
```

### Admins

```
GET  /admins
POST /admins
PUT  /admins/{id}
```

### Sessions

```
GET  /sessions
POST /sessions/{id}/revoke
```

๐

* ุฃู Endpoint ุบูุฑ ูุฐููุฑ ููุง = ุบูุฑ ูุชุงุญ
* ููุณุช Contract ููุงุฆู ููู UI

---

## 8๏ธโฃ Frontend & Twig โ HOW TO WORK SAFELY

### ููุงู ุงููุงุฌูุงุช

```
templates/
```

### ููุงุนุฏ ุตุงุฑูุฉ

1. Controller โ View
2. โ ูุง Logic ุฃููู ูู Twig
3. Escape ุฏุงุฆููุง:

   ```twig
   {{ value|e }}
   ```
4. Translation Keys ููุท
5. ูุง ุชูุชุฑุถ ูุฌูุฏ ุฃู ุชุฑุชูุจ ุงูุญููู ุฏุงุฎู DTOs

---

## 9๏ธโฃ ููุงุนุฏ ุฐูุจูุฉ ูููุฑูููู

1. โ ูุง Auth Logic ูุฏูู
2. โ ูุง ุชุบููุฑ Permission Semantics
3. โ Session โ Identity
4. โ ูุง ุชุนุฑุถ `admin_id` ูู UI
5. โ ุฃู ุดู = ุงุณุฃู

---

## ๐ ุญุฏูุฏ ุงููุฑุญูุฉ ุงูุญุงููุฉ (Phase Boundary)

ูุญู ูู ูุฑุญูุฉ:

### **Infrastructure & Core Security**

**ููุชูู**

* Login
* Sessions
* TOTP / Step-Up
* Audit (Transactional Outbox)

**ุบูุฑ ูุณููุญ**

* Business Logic
* Features ุฎุงุตุฉ ุจุงูููุชุฌ ุงูููุงุฆู

---
## โ๏ธ ููุงุญุธุฉ ูููุฉ ููุทูุฑู ุงููุงุฌูุงุช ุจุฎุตูุต .env
ููู .env ูุญุชูู ุนูู ุฅุนุฏุงุฏุงุช ุญุณุงุณุฉ.
ููุทูุฑ ูุงุฌูุงุช:
- ุนุฏูู ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุท
- ูุง ุชุบููุฑ ุฃู ููุงุชูุญ ุชุดููุฑ
- ูุง ุชูุนูู ุฃู Recovery ุฃู Security Flags

ูู ุญุงู ุชููู ุงููุธุงูุ ุงุณุฃู ุงููุฑูู ุงูุฃุณุงุณู.


---

## ๐ ุฎุงุชูุฉ

ูุฐุง ุงูููู ูู **ุงููุฑุฌุน ุงููุญูุฏ ููุชุดุบูู**.

* ุฃู ุชุนุงุฑุถ โ ูุฐุง ุงูููู ูู ุงูุตุญูุญ
* ุฃู ุงูุชุฑุงุญ ุชุทููุฑ โ ุฎุงุฑุฌ ูุฐุง ุงูุฏููู

**ุงุดุชุบู ุจุญุฐุฑุ ูุงููุธุงู ููุดุชุบู ูุนุงู ๐**

---
